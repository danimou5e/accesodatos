package mx.gob.imss.cit.sci.mssci.accesodatos.constants;

public class SQLTodasIncapacidades {

	private SQLTodasIncapacidades() {}

	// ADSCRIPCION ------------------------

	public static final String QS_INC_TODAS_ACT_ADSC_CON_CLASIFICACION_DEL_CASO = " with comentarios as (select caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad, max( coment.cve_id_comentario ) as cve_id_comentario, max( coment.stp_fecha_comentario ) as stp_fecha_comentario from scit_caso_activos caso inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_paciente pac on caso.cve_id_paciente = pac.cve_id_paciente inner join scic_unidad uni on pac.cve_id_unidad = uni.cve_id_unidad inner join scic_delegacion del on del.cve_id_delegacion = uni.cve_id_delegacion inner join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left join scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo where caso.cve_id_estado_incapacidad IN (?, ?) and (? IS NULL OR del.cve_id_delegacion = ?) and (? IS NULL OR coment.cve_id_clasificacion = ?) and (? IS NULL OR uni.cve_id_unidad = ?) and (? IS NULL OR ramo.cve_id_ramo = ?) and (? IS NULL OR pac.tip_marca_pago = ?) and (? IS NULL OR pac.tip_marca_pago <> ?) and (? IS NULL OR pac.ref_nss = ?) and (? IS NULL OR pac.ref_curp = ?) and (? IS NULL OR pac.cve_id_turno = ?) and (? IS NULL OR pac.num_consultorio = ?) and (? IS NULL OR pac.nom_nombre_pac = ?) and (? IS NULL OR pac.nom_apellido_paterno_pac = ?) and (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 group by caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad ) SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, cmmt.cve_id_unidad AS IDUNIDAD, cmmt.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, si.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, si.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, si.num_dias_prob_rec AS DPR, si.cve_matricula_med AS MATRICULAMEDICO, si.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION from scit_caso_activos caso inner join comentarios cmmt on cmmt.cve_Id_caso = caso.cve_id_caso inner join scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_comentario coment on coment.cve_id_comentario = cmmt.cve_id_comentario INNER JOIN scic_unidad uni ON uni.cve_id_unidad = cmmt.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scic_unidad uni2 ON si.cve_id_unidad_expedicion=uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = si.cve_id_cie INNER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE si.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) group by cmmt.cve_id_caso, si.cve_id_caso order by caso.num_dias_acumulados DESC, cmmt.cve_id_caso DESC ";

	public static final String QS_INC_TODAS_ACT_ADSC_SIN_CLASIFICACION_DEL_CASO = " ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, pac.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, '' AS CVECLASIFICACION, '' AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION FROM scit_caso_activos caso INNER JOIN scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente INNER JOIN scic_unidad uni ON pac.cve_id_unidad = uni.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_incapacidad inc ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie left outer join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario IS NULL and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) UNION ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, pac.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION FROM scit_caso_activos caso INNER JOIN scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente INNER JOIN scic_unidad uni ON pac.cve_id_unidad = uni.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_incapacidad inc ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie left outer join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left outer JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) ORDER BY DIASACUMULADOSINCAPACIDAD DESC, INICIOCASO DESC, NSS DESC ";

	public static final String QS_INC_TODAS_RST_ADSC_CON_CLASIFICACION_DEL_CASO = " with comentarios as (select caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad, max( coment.cve_id_comentario ) cve_id_comentario, max( coment.stp_fecha_comentario ) stp_fecha_comentario from scit_caso caso inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_paciente pac on caso.cve_id_paciente = pac.cve_id_paciente inner join scic_unidad uni on pac.cve_id_unidad = uni.cve_id_unidad inner join scic_delegacion del on del.cve_id_delegacion = uni.cve_id_delegacion inner join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left join scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo where caso.cve_id_estado_incapacidad IN (?, ?) and (? IS NULL OR del.cve_id_delegacion = ?) and (? IS NULL OR coment.cve_id_clasificacion = ?) and (? IS NULL OR uni.cve_id_unidad = ?) and (? IS NULL OR ramo.cve_id_ramo = ?) and (? IS NULL OR pac.tip_marca_pago = ?) and (? IS NULL OR pac.tip_marca_pago <> ?) and (? IS NULL OR pac.ref_nss = ?) and (? IS NULL OR pac.ref_curp = ?) and (? IS NULL OR pac.cve_id_turno = ?) and (? IS NULL OR pac.num_consultorio = ?) and (? IS NULL OR pac.nom_nombre_pac = ?) and (? IS NULL OR pac.nom_apellido_paterno_pac = ?) and (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 group by caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad ) SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, cmmt.cve_id_unidad AS IDUNIDAD, cmmt.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, si.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, si.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, si.num_dias_prob_rec AS DPR, si.cve_matricula_med AS MATRICULAMEDICO, si.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION from scit_caso caso inner join comentarios cmmt on cmmt.cve_Id_caso = caso.cve_id_caso inner join scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_comentario coment on coment.cve_id_comentario = cmmt.cve_id_comentario INNER JOIN scic_unidad uni ON uni.cve_id_unidad = cmmt.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scic_unidad uni2 ON si.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = si.cve_id_cie INNER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE si.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) group by cmmt.cve_id_caso, si.cve_id_caso order by caso.num_dias_acumulados DESC, cmmt.cve_id_caso DESC ";

	public static final String QS_INC_TODAS_RST_ADSC_SIN_CLASIFICACION_DEL_CASO = " ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, pac.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION FROM scit_caso caso INNER JOIN scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente INNER JOIN scic_unidad uni ON pac.cve_id_unidad = uni.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_incapacidad inc ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie left outer join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left outer JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario IS NULL and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) UNION ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, pac.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION FROM scit_caso caso INNER JOIN scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente INNER JOIN scic_unidad uni ON pac.cve_id_unidad = uni.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_incapacidad inc ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie left outer join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left outer JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) ORDER BY DIASACUMULADOSINCAPACIDAD DESC, INICIOCASO DESC, NSS DESC ";

	// EXPEDICION ---------------------------------------------------------------------------------------------------------------

	public static final String QS_INC_TODAS_ACT_EXP_CON_CLASIFICACION_DEL_CASO = " with comentarios as (select caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad, max( coment.cve_id_comentario ) as cve_id_comentario, max( coment.stp_fecha_comentario ) as stp_fecha_comentario from scit_incapacidad si inner join scit_caso_activos caso on caso.cve_id_caso = si.cve_id_caso inner join scic_unidad uni on uni.cve_id_unidad = si.cve_id_unidad_expedicion inner join scic_delegacion del on del.cve_id_delegacion = uni.cve_id_delegacion inner join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso inner join scit_paciente pac on caso.cve_id_paciente = pac.cve_id_paciente left join scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo where caso.cve_id_estado_incapacidad IN (?, ?) and (? IS NULL OR del.cve_id_delegacion = ?) and (? IS NULL OR coment.cve_id_clasificacion = ?) and (? IS NULL OR si.cve_id_unidad_expedicion = ?) and (? IS NULL OR ramo.cve_id_ramo = ?) and (? IS NULL OR pac.tip_marca_pago = ?) and (? IS NULL OR pac.tip_marca_pago <> ?) and (? IS NULL OR pac.ref_nss = ?) and (? IS NULL OR pac.ref_curp = ?) and (? IS NULL OR pac.cve_id_turno = ?) and (? IS NULL OR pac.num_consultorio = ?) and (? IS NULL OR pac.nom_nombre_pac = ?) and (? IS NULL OR pac.nom_apellido_paterno_pac = ?) and (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 AND si.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) group by caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad ) SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, cmmt.cve_id_unidad AS IDUNIDAD, cmmt.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, si.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, si.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, si.num_dias_prob_rec AS DPR, si.cve_matricula_med AS MATRICULAMEDICO, si.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION from scit_caso_activos caso inner join comentarios cmmt on cmmt.cve_Id_caso = caso.cve_id_caso inner join scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_comentario coment on coment.cve_id_comentario = cmmt.cve_id_comentario INNER JOIN scic_unidad uni ON uni.cve_id_unidad = cmmt.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scic_unidad uni2 ON si.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = si.cve_id_cie INNER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE si.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) group by cmmt.cve_id_caso, si.cve_id_caso order by caso.num_dias_acumulados DESC, cmmt.cve_id_caso DESC ";

	public static final String QS_INC_TODAS_ACT_EXP_SIN_CLASIFICACION_DEL_CASO = " (SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, uni.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, MAX(coment.ref_texto) AS COMENTARIO, MAX(clas.cve_clasificacion) AS CVECLASIFICACION, MAX(clas.des_clasificacion) AS DESCCLASIFICACION, MAX(coment.stp_fecha_comentario) AS FECCOMENTARIO, MAX(coment.stp_fecha_revaloracion) AS PROXIMAVALORACION FROM scit_incapacidad inc INNER JOIN scit_caso_activos caso ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni ON uni.cve_id_unidad = inc.cve_id_unidad_expedicion INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_paciente pac ON pac.cve_id_paciente = caso.cve_id_paciente INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie LEFT OUTER JOIN scit_comentario coment ON coment.cve_id_caso = caso.cve_id_caso LEFT OUTER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario IS NULL and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) UNION ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, uni.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, MAX(coment.ref_texto) AS COMENTARIO, MAX(clas.cve_clasificacion) AS CVECLASIFICACION, MAX(clas.des_clasificacion) AS DESCCLASIFICACION, MAX(coment.stp_fecha_comentario) AS FECCOMENTARIO, MAX(coment.stp_fecha_revaloracion) AS PROXIMAVALORACION FROM scit_incapacidad inc INNER JOIN scit_caso_activos caso ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni ON uni.cve_id_unidad = inc.cve_id_unidad_expedicion INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_paciente pac ON pac.cve_id_paciente = caso.cve_id_paciente INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie LEFT OUTER JOIN scit_comentario coment ON coment.cve_id_caso = caso.cve_id_caso LEFT OUTER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) ORDER BY DIASACUMULADOSINCAPACIDAD DESC, INICIOCASO DESC, NSS DESC ";

	public static final String QS_INC_TODAS_RST_EXP_CON_CLASIFICACION_DEL_CASO = " with comentarios as (select caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad, max( coment.cve_id_comentario ) as cve_id_comentario, max( coment.stp_fecha_comentario ) as stp_fecha_comentario from scit_incapacidad si inner join scit_caso caso on caso.cve_id_caso = si.cve_id_caso inner join scit_paciente pac on caso.cve_id_paciente = pac.cve_id_paciente inner join scic_unidad uni on pac.cve_id_unidad = uni.cve_id_unidad inner join scic_delegacion del on del.cve_id_delegacion = uni.cve_id_delegacion inner join scit_comentario coment on coment.cve_id_caso = caso.cve_id_caso left join scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo where caso.cve_id_estado_incapacidad IN (?, ?) and (? IS NULL OR del.cve_id_delegacion = ?) and (? IS NULL OR coment.cve_id_clasificacion = ?) and (? IS NULL OR si.cve_id_unidad_expedicion = ?) and (? IS NULL OR ramo.cve_id_ramo = ?) and (? IS NULL OR pac.tip_marca_pago = ?) and (? IS NULL OR pac.tip_marca_pago <> ?) and (? IS NULL OR pac.ref_nss = ?) and (? IS NULL OR pac.ref_curp = ?) and (? IS NULL OR pac.cve_id_turno = ?) and (? IS NULL OR pac.num_consultorio = ?) and (? IS NULL OR pac.nom_nombre_pac = ?) and (? IS NULL OR pac.nom_apellido_paterno_pac = ?) and (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 group by caso.cve_id_caso, uni.des_nombre_unidad, uni.cve_id_unidad ) SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, cmmt.cve_id_unidad AS IDUNIDAD, cmmt.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, si.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, si.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, si.num_dias_prob_rec AS DPR, si.cve_matricula_med AS MATRICULAMEDICO, si.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, coment.ref_texto AS COMENTARIO, clas.cve_clasificacion AS CVECLASIFICACION, clas.des_clasificacion AS DESCCLASIFICACION, coment.stp_fecha_comentario AS FECCOMENTARIO, coment.stp_fecha_revaloracion AS PROXIMAVALORACION from scit_caso caso inner join comentarios cmmt on cmmt.cve_Id_caso = caso.cve_id_caso inner join scit_paciente pac ON caso.cve_id_paciente = pac.cve_id_paciente inner join scit_incapacidad si on caso.cve_id_caso = si.cve_id_caso inner join scit_comentario coment on coment.cve_id_comentario = cmmt.cve_id_comentario INNER JOIN scic_unidad uni ON uni.cve_id_unidad = cmmt.cve_id_unidad INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scic_unidad uni2 ON si.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = si.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = si.cve_id_cie INNER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE si.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) group by cmmt.cve_id_caso, si.cve_id_caso order by caso.num_dias_acumulados DESC, cmmt.cve_id_caso DESC ";

	public static final String QS_INC_TODAS_RST_EXP_SIN_CLASIFICACION_DEL_CASO = "( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, uni.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, MAX(coment.ref_texto) AS COMENTARIO, MAX(clas.cve_clasificacion) AS CVECLASIFICACION, MAX(clas.des_clasificacion) AS DESCCLASIFICACION, MAX(coment.stp_fecha_comentario) AS FECCOMENTARIO, MAX(coment.stp_fecha_revaloracion) AS PROXIMAVALORACION FROM scit_incapacidad inc INNER JOIN scit_caso caso ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni ON uni.cve_id_unidad = inc.cve_id_unidad_expedicion INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_paciente pac ON pac.cve_id_paciente = caso.cve_id_paciente INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie LEFT OUTER JOIN scit_comentario coment ON coment.cve_id_caso = caso.cve_id_caso LEFT OUTER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario IS NULL and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) UNION ( SELECT caso.cve_id_caso as IDCASO, pac.cve_id_paciente AS IDPACIENTE, pac.nom_nombre_pac AS NOMBREPACIENTE, pac.nom_apellido_paterno_pac AS PRIMERAPELLIDO, pac.nom_apellido_materno_pac AS SEGUNDOAPELLIDO, pac.ref_nss AS NSS, uni.cve_id_unidad AS IDUNIDAD, uni.des_nombre_unidad NOMBREUNIDAD, uni2.des_nombre_unidad NOMBREUNIDADEXP, del.cve_id_delegacion AS IDDELEGACION, del.des_delegacion NOMBREDELEGACION, caso.num_dias_acumulados AS DIASACUMULADOSINCAPACIDAD, caso.fec_ini_caso AS INICIOCASO, caso.fec_ult_incap_caso AS FINCASO, inc.cve_id_incapacidad as IDINCAPACIDAD, pac.ref_curp AS CURP, pac.num_consultorio AS UMF, tur.des_turno AS NOMBRETURNO, ramo.des_ramo AS DESCRAMO, ciuo.des_ciuo AS DESCOCUPACION, caso.imp_monto_acumulado AS MONTOACUMULADOSUBSIDIO, inc.ref_diagnostico AS ULTIMODIAGNOSTICO, cie.cve_cie AS CVECIE, inc.num_dias_prob_rec AS DPR, inc.cve_matricula_med AS MATRICULAMEDICO, inc.cve_reg_patronal AS CVEREGISTROPATRONAL, ciuo.cve_id_ciuo AS IDOCUPACION, cie.cve_id_cie AS IDCIE, tur.cve_id_turno AS IDTURNO, MAX(coment.ref_texto) AS COMENTARIO, MAX(clas.cve_clasificacion) AS CVECLASIFICACION, MAX(clas.des_clasificacion) AS DESCCLASIFICACION, MAX(coment.stp_fecha_comentario) AS FECCOMENTARIO, MAX(coment.stp_fecha_revaloracion) AS PROXIMAVALORACION FROM scit_incapacidad inc INNER JOIN scit_caso caso ON inc.cve_id_caso = caso.cve_id_caso INNER JOIN scic_unidad uni ON uni.cve_id_unidad = inc.cve_id_unidad_expedicion INNER JOIN scic_delegacion del ON del.cve_id_delegacion = uni.cve_id_delegacion INNER JOIN scit_paciente pac ON pac.cve_id_paciente = caso.cve_id_paciente INNER JOIN scic_unidad uni2 ON inc.cve_id_unidad_expedicion = uni2.cve_id_unidad LEFT JOIN scic_ciuo ciuo ON pac.cve_id_ciuo = ciuo.cve_id_ciuo LEFT JOIN scic_turno tur ON tur.cve_id_turno = pac.cve_id_turno LEFT JOIN scic_ramo ramo ON ramo.cve_id_ramo = inc.cve_id_ramo LEFT JOIN scic_cie cie ON cie.cve_id_cie = inc.cve_id_cie LEFT OUTER JOIN scit_comentario coment ON coment.cve_id_caso = caso.cve_id_caso LEFT OUTER JOIN scic_clasificacion clas ON clas.cve_id_clasificacion = coment.cve_id_clasificacion WHERE caso.cve_id_estado_incapacidad IN (?, ?) AND (? IS NULL OR del.cve_id_delegacion = ?) AND (? IS NULL OR uni.cve_id_unidad = ?) AND (? IS NULL OR ramo.cve_id_ramo = ?) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 1) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR inc.tip_empleado_imss = 0) AND (? IS NULL OR pac.ref_nss = ?) AND (? IS NULL OR pac.ref_curp = ?) AND (? IS NULL OR pac.cve_id_turno = ?) AND (? IS NULL OR pac.num_consultorio = ?) AND (? IS NULL OR pac.nom_nombre_pac = ?) AND (? IS NULL OR pac.nom_apellido_paterno_pac = ?) AND (? IS NULL OR pac.nom_apellido_materno_pac = ?) and coment.ind_ult_comentario = 1 and inc.cve_id_incapacidad in (select max(cve_id_incapacidad) from scit_incapacidad inc_caso where caso.cve_id_caso = inc_caso.cve_id_caso) GROUP BY uni.cve_id_unidad, inc.cve_id_caso ORDER BY caso.num_dias_acumulados DESC, caso.fec_ini_caso DESC, pac.ref_nss DESC ) ORDER BY DIASACUMULADOSINCAPACIDAD DESC, INICIOCASO DESC, NSS DESC ";

}
